/*! openvod | emma | ISC */
"use strict";!function(){angular.module("app.controllers",[]).controller("indexController",["$scope",function(a){this.init=function(){this.maskUrl=""}}]).controller("loginController",["$scope","$http","$state","$filter","md5","util",function(a,b,c,d,e,f){var g=this;g.init=function(){},g.login=function(){g.loading=!0;var a=JSON.stringify({username:g.userName,password:e.createHash(g.password)});b({method:"POST",url:f.getApiUrl("v1/logon","","server"),data:a}).then(function(a){var b=a.data;"200"==b.rescode?(f.setParams("token",b.token),g.getEditLangs()):alert(b.rescode+" "+b.errInfo)},function(a){alert("连接服务器出错")}).finally(function(a){g.loading=!1})},g.getEditLangs=function(){b({method:"GET",url:f.getApiUrl("","editLangs.json","local")}).then(function(a){f.setParams("editLangs",a.data.editLangs),c.go("app.home")},function(a){})}}]).controller("appController",["$http","$scope","$state","$stateParams","util","CONFIG",function(a,b,c,d,e,f){var g=this;g.init=function(){g.maskUrl="",g.maskParams={}},g.showHideMask=function(a,c){a?(b.app.maskUrl=c,b.app.showMaskClass=!0):(b.app.maskUrl="",b.app.showMaskClass=!1)}}]).controller("homeController",["$http","$scope","$state","$location","$filter","$stateParams","$q","util","CONFIG",function(a,b,c,d,e,f,g,h,i){var j=this;j.init=function(){j.getProject()},j.logout=function(){h.setParams("token",""),c.go("login")},j.getProject=function(){var c=g.defer(),d=JSON.stringify({token:h.getParams("token"),action:"projectList"});a({method:"POST",url:h.getApiUrl("v1/project","","server"),data:d}).then(function(a){var d=a.data;"200"==d.rescode?(b.app.projectList=[],b.app.projectList.push({projectName:"all",projectNameCHZ:"所有项目"}),d.data.forEach(function(a){b.app.projectList.push({projectName:a.ProjectName,projectNameCHZ:a.ProjectNameCHZ})}),c.resolve()):(alert(d.errInfo),c.reject())},function(a){alert("连接服务器出错"),c.reject()}).finally(function(a){j.loadingChart0=!1})}}]).controller("overviewController",["$http","$scope","$state","$location","$filter","$stateParams","$q","util","CONFIG",function(a,b,c,d,e,f,g,h,i){var j=this;j.init=function(){j.project=[{name:"opennVoD"},{name:"西塘"}],j.term=[{name:"累计终端",value:!0,sort:"",desc:!1},{name:"上线终端",value:!0,sort:"",desc:!1},{name:"活跃终端",value:!0,sort:"",desc:!1}],j.activerow=0,j.initCharts(),j.loadChart()},j.isCurrent=function(a){j.activerow=a},j.initCharts=function(){j.attrs0={caption:" ",xAxisname:"时间",yAxisName:"开机率",numberPrefix:"",numberSuffix:"%",plotFillAlpha:"",paletteColors:"#0075c2,#1aaf5d",baseFontColor:"#333333",baseFont:"Helvetica Neue,Arial",captionFontSize:"14",subcaptionFontSize:"14",subcaptionFontBold:"0",showBorder:"0",bgColor:"#ffffff",showShadow:"0",canvasBgColor:"#ffffff",canvasBorderAlpha:"0",divlineAlpha:"100",divlineColor:"#999999",divlineThickness:"1",divLineIsDashed:"1",divLineDashLen:"1",divLineGapLen:"1",usePlotGradientColor:"0",showplotborder:"0",valueFontColor:"#ffffff",placeValuesInside:"1",showHoverEffect:"1",rotateValues:"0",showXAxisLine:"1",xAxisLineThickness:"1",xAxisLineColor:"#999999",showAlternateHGridColor:"0",legendBgAlpha:"0",legendBorderAlpha:"0",legendShadow:"0",legendItemFontSize:"10",legendItemFontColor:"#666666"},j.categories0=[{category:[]}],j.dataset0=[],j.attrs1={caption:"",xAxisname:"时间",yAxisName:"活跃率",numberPrefix:"",numberSuffix:"%",plotFillAlpha:"",paletteColors:"#0075c2,#1aaf5d",baseFontColor:"#333333",baseFont:"Helvetica Neue,Arial",captionFontSize:"14",subcaptionFontSize:"14",subcaptionFontBold:"0",showBorder:"0",bgColor:"#ffffff",showShadow:"0",canvasBgColor:"#ffffff",canvasBorderAlpha:"0",divlineAlpha:"100",divlineColor:"#999999",divlineThickness:"1",divLineIsDashed:"1",divLineDashLen:"1",divLineGapLen:"1",usePlotGradientColor:"0",showplotborder:"0",valueFontColor:"#ffffff",placeValuesInside:"1",showHoverEffect:"1",rotateValues:"0",showXAxisLine:"1",xAxisLineThickness:"1",xAxisLineColor:"#999999",showAlternateHGridColor:"0",legendBgAlpha:"0",legendBorderAlpha:"0",legendShadow:"0",legendItemFontSize:"10",legendItemFontColor:"#666666"},j.categories1=[{category:[]}],j.dataset1=[],j.attrs2={caption:"",xAxisname:"时间",yAxisName:"付费转化率",numberPrefix:"",numberSuffix:"%",plotFillAlpha:"",paletteColors:"#0075c2,#1aaf5d",baseFontColor:"#333333",baseFont:"Helvetica Neue,Arial",captionFontSize:"14",subcaptionFontSize:"14",subcaptionFontBold:"0",showBorder:"0",bgColor:"#ffffff",showShadow:"0",canvasBgColor:"#ffffff",canvasBorderAlpha:"0",divlineAlpha:"100",divlineColor:"#999999",divlineThickness:"1",divLineIsDashed:"1",divLineDashLen:"1",divLineGapLen:"1",usePlotGradientColor:"0",showplotborder:"0",valueFontColor:"#ffffff",placeValuesInside:"1",showHoverEffect:"1",rotateValues:"0",showXAxisLine:"1",xAxisLineThickness:"1",xAxisLineColor:"#999999",showAlternateHGridColor:"0",legendBgAlpha:"0",legendBorderAlpha:"0",legendShadow:"0",legendItemFontSize:"10",legendItemFontColor:"#666666"},j.categories2=[{category:[]}],j.dataset2=[],j.attrs3={caption:"",xAxisname:"时间",yAxisName:"平均终端营收",numberPrefix:"",numberSuffix:"%",plotFillAlpha:"",paletteColors:"#0075c2,#1aaf5d",baseFontColor:"#333333",baseFont:"Helvetica Neue,Arial",captionFontSize:"14",subcaptionFontSize:"14",subcaptionFontBold:"0",showBorder:"0",bgColor:"#ffffff",showShadow:"0",canvasBgColor:"#ffffff",canvasBorderAlpha:"0",divlineAlpha:"100",divlineColor:"#999999",divlineThickness:"1",divLineIsDashed:"1",divLineDashLen:"1",divLineGapLen:"1",usePlotGradientColor:"0",showplotborder:"0",valueFontColor:"#ffffff",placeValuesInside:"1",showHoverEffect:"1",rotateValues:"0",showXAxisLine:"1",xAxisLineThickness:"1",xAxisLineColor:"#999999",showAlternateHGridColor:"0",legendBgAlpha:"0",legendBorderAlpha:"0",legendShadow:"0",legendItemFontSize:"10",legendItemFontColor:"#666666"},j.categories3=[{category:[]}],j.dataset3=[]},j.loadChart=function(){var b=g.defer();j.dataSet0=[],j.dataSet1=[],j.dataSet2=[],j.dataSet3=[];var c=JSON.stringify({token:h.getParams("token"),action:"getTermOnlineRateInfo",endTime:"2017-03-23 10:00:00",project:["all"],timespans:7,type:2});j.loadingChart0=!0,a({method:"POST",url:h.getApiUrl("v2/statistics","","server"),data:c}).then(function(a){var c=a.data;"200"==c.rescode?(j.categories0[0].category=[],c.timeList.forEach(function(a,b){j.categories0[0].category.push({label:a.substring(5,16)}),j.dataSet0.push({datetime:a.substring(5,16)})}),j.dataset0.push({seriesname:"开机率",data:[]}),c.onlineRate.forEach(function(a,b){j.dataset0[0].data.push({value:100*a}),j.dataSet0[b].onlineRate=100*a+"%"}),b.resolve()):(alert(c.errInfo),b.reject())},function(a){alert("连接服务器出错"),b.reject()}).finally(function(a){j.loadingChart0=!1});var c=JSON.stringify({token:h.getParams("token"),action:"getTermActiveRateInfo",endTime:"2017-03-23 10:00:00",project:["all"],timespans:7,type:2});j.loadingChart1=!0,a({method:"POST",url:h.getApiUrl("v2/statistics","","server"),data:c}).then(function(a){var c=a.data;"200"==c.rescode?(j.categories1[0].category=[],c.timeList.forEach(function(a,b){j.categories1[0].category.push({label:a.substring(5,16)}),j.dataSet1.push({datetime:a.substring(5,16)})}),j.dataset1.push({seriesname:"活跃率",data:[]}),c.activeRate.forEach(function(a,b){j.dataset1[0].data.push({value:100*a}),j.dataSet1[b].activeRate=100*a+"%"}),b.resolve()):(alert(c.errInfo),b.reject())},function(a){alert("连接服务器出错"),b.reject()}).finally(function(a){j.loadingChart1=!1});var c=JSON.stringify({token:h.getParams("token"),action:"getTermPayRateInfo",endTime:"2017-03-23 10:00:00",project:["all"],timespans:7,type:2});j.loadingChart2=!0,a({method:"POST",url:h.getApiUrl("v2/statistics","","server"),data:c}).then(function(a){var c=a.data;"200"==c.rescode?(j.categories2[0].category=[],c.timeList.forEach(function(a,b){j.categories2[0].category.push({label:a.substring(5,16)}),j.dataSet2.push({datetime:a.substring(5,16)})}),j.dataset2.push({seriesname:"付费转化率",data:[]}),c.payRate.forEach(function(a,b){j.dataset2[0].data.push({value:100*a}),j.dataSet2[b].payRate=100*a+"%"}),b.resolve()):(alert(c.errInfo),b.reject())},function(a){alert("连接服务器出错"),b.reject()}).finally(function(a){j.loadingChart2=!1});var c=JSON.stringify({token:h.getParams("token"),action:"getPerTermRevenueInfo",endTime:"2017-03-23 10:00:00",project:["all"],timespans:7,type:2});return j.loadingChart3=!0,a({method:"POST",url:h.getApiUrl("v2/statistics","","server"),data:c}).then(function(a){var c=a.data;"200"==c.rescode?(j.categories3[0].category=[],c.timeList.forEach(function(a,b){j.categories3[0].category.push({label:a.substring(5,16)}),j.dataSet3.push({datetime:a.substring(5,16)})}),j.dataset3.push({seriesname:"付费转化率",data:[]}),c.revenue.forEach(function(a,b){j.dataset3[0].data.push({value:100*a}),j.dataSet3[b].revenue=100*a+"%"}),b.resolve()):(alert(c.errInfo),b.reject())},function(a){alert("连接服务器出错"),b.reject()}).finally(function(a){j.loadingChart3=!1}),b.promise},j.changeOrderby=function(a){j.term.sort=a,j.term.desc=!j.term.desc}}]).controller("specificController",["$http","$scope","$state","$location","$filter","$stateParams","$q","util","CONFIG",function(a,b,c,d,e,f,g,h,i){var j=this;j.init=function(){j.project=[{name:"opennVoD"},{name:"西塘"}],j.activerow=0,j.term=[{name:"累计终端",show:!0,sort:"",desc:!1},{name:"上线终端",show:!0,sort:"",desc:!1},{name:"活跃终端",show:!0,sort:"",desc:!1},{name:"付费终端",show:!1,sort:"",desc:!1},{name:"新增终端",show:!1,sort:"",desc:!1}],j.countStatistics=[{name:"准付费次数",show:!1,sort:"",desc:!1},{name:"付 费 次 数",show:!0,sort:"",desc:!1}],j.selectCount=3,j.other=[{name:"活跃时长",show:!0,sort:"",desc:!1},{name:"西塘票务",show:!1,sort:"",desc:!1}],j.initCharts(),j.loadChart(),j.orderby={},j.orderby.desc=!1},j.isCurrent=function(a){j.activerow!=a&&(j.activerow=a,j.loadChart())},j.selectTerm=function(a){if(1==j.term[a].show)j.selectCount--;else{if(!(0==j.term[a].show&&j.selectCount<3))return alert("最多只能选择3个显示！"),!1;j.selectCount++}j.term[a].show=!j.term[a].show,j.series0=[],j.term.forEach(function(a,b){1==a.show&&j.series0.push(j.dataset0[b])}),j.dataset0=j.series0},j.selectCountStatistics=function(a){0==j.countStatistics[a].show&&(0==a?(j.countStatistics[0].show=!0,j.countStatistics[1].show=!1,j.dataset1=j.wantPaySeries,j.dataSet1=j.wantPayData):(j.countStatistics[0].show=!1,j.countStatistics[1].show=!0,j.dataset1=j.paySeries,j.dataSet1=j.payData))},j.selectOther=function(a){j.other.forEach(function(a){a.show=!1}),j.other[a].show=!0},j.initCharts=function(){j.attrs0={caption:" ",xAxisname:"时间",yAxisName:"终端",numberPrefix:"",numberSuffix:" 个",plotFillAlpha:"",paletteColors:"#0075c2,#1aaf5d",baseFontColor:"#333333",baseFont:"Helvetica Neue,Arial",captionFontSize:"14",subcaptionFontSize:"14",subcaptionFontBold:"0",showBorder:"0",bgColor:"#ffffff",showShadow:"0",canvasBgColor:"#ffffff",canvasBorderAlpha:"0",divlineAlpha:"100",divlineColor:"#999999",divlineThickness:"1",divLineIsDashed:"1",divLineDashLen:"1",divLineGapLen:"1",usePlotGradientColor:"0",showplotborder:"0",valueFontColor:"#ffffff",placeValuesInside:"1",showHoverEffect:"1",rotateValues:"0",showXAxisLine:"1",xAxisLineThickness:"1",xAxisLineColor:"#999999",showAlternateHGridColor:"0",legendBgAlpha:"0",legendBorderAlpha:"0",legendShadow:"0",legendItemFontSize:"10",legendItemFontColor:"#666666"},j.categories0=[{category:[]}],j.dataset0=[],j.attrs1={caption:" ",xAxisname:"时间",yAxisName:"次数",numberPrefix:"",numberSuffix:" 次",plotFillAlpha:"",paletteColors:"#0075c2,#1aaf5d",baseFontColor:"#333333",baseFont:"Helvetica Neue,Arial",captionFontSize:"14",subcaptionFontSize:"14",subcaptionFontBold:"0",showBorder:"0",bgColor:"#ffffff",showShadow:"0",canvasBgColor:"#ffffff",canvasBorderAlpha:"0",divlineAlpha:"100",divlineColor:"#999999",divlineThickness:"1",divLineIsDashed:"1",divLineDashLen:"1",divLineGapLen:"1",usePlotGradientColor:"0",showplotborder:"0",valueFontColor:"#ffffff",placeValuesInside:"1",showHoverEffect:"1",rotateValues:"0",showXAxisLine:"1",xAxisLineThickness:"1",xAxisLineColor:"#999999",showAlternateHGridColor:"0",legendBgAlpha:"0",legendBorderAlpha:"0",legendShadow:"0",legendItemFontSize:"10",legendItemFontColor:"#666666"},j.categories1=[{category:[]}],j.dataset1=[],j.attrs2={caption:" ",xAxisname:"时间",yAxisName:"金额",numberPrefix:"¥ ",numberSuffix:"",plotFillAlpha:"",paletteColors:"#0075c2,#1aaf5d",baseFontColor:"#333333",baseFont:"Helvetica Neue,Arial",captionFontSize:"14",subcaptionFontSize:"14",subcaptionFontBold:"0",showBorder:"0",bgColor:"#ffffff",showShadow:"0",canvasBgColor:"#ffffff",canvasBorderAlpha:"0",divlineAlpha:"100",divlineColor:"#999999",divlineThickness:"1",divLineIsDashed:"1",divLineDashLen:"1",divLineGapLen:"1",usePlotGradientColor:"0",showplotborder:"0",valueFontColor:"#ffffff",placeValuesInside:"1",showHoverEffect:"1",rotateValues:"0",showXAxisLine:"1",xAxisLineThickness:"1",xAxisLineColor:"#999999",showAlternateHGridColor:"0",legendBgAlpha:"0",legendBorderAlpha:"0",legendShadow:"0",legendItemFontSize:"10",legendItemFontColor:"#666666"},j.categories2=[{category:[]}],j.dataset2=[],j.attrs3={caption:" ",xAxisname:"时间",pYAxisName:"活跃时长",sYAxisName:"活跃终端数",numberPrefix:"",numberSuffix:"",plotFillAlpha:"",paletteColors:"#0075c2,#1aaf5d",baseFontColor:"#333333",baseFont:"Helvetica Neue,Arial",captionFontSize:"14",subcaptionFontSize:"14",subcaptionFontBold:"0",showBorder:"0",bgColor:"#ffffff",showShadow:"0",canvasBgColor:"#ffffff",canvasBorderAlpha:"0",divlineAlpha:"100",divlineColor:"#999999",divlineThickness:"1",divLineIsDashed:"1",divLineDashLen:"1",divLineGapLen:"1",usePlotGradientColor:"0",showplotborder:"0",valueFontColor:"#ffffff",placeValuesInside:"1",showHoverEffect:"1",rotateValues:"0",showXAxisLine:"1",xAxisLineThickness:"1",xAxisLineColor:"#999999",showAlternateHGridColor:"0",legendBgAlpha:"0",legendBorderAlpha:"0",legendShadow:"0",legendItemFontSize:"10",legendItemFontColor:"#666666"},j.categories3=[{category:[]}],j.dataset3=[]},j.loadChart=function(){var b=g.defer();switch(j.dataset0=[],j.dataset1=[],j.dataset2=[],j.dataset3=[],j.activerow){case 0:!function(){j.dataSet0=[],j.series0=[];var c=JSON.stringify({token:h.getParams("token"),action:"getTermStatisticsInfo",endTime:"2017-03-23 10:00:00",project:["all"],timespans:7,type:2});j.loadingChart0=!0,a({method:"POST",url:h.getApiUrl("v2/statistics","","server"),data:c}).then(function(a){var c=a.data;"200"==c.rescode?(j.categories0[0].category=[],c.timeList.forEach(function(a,b){j.categories0[0].category.push({label:a.substring(5,16)}),j.dataSet0.push({datetime:a.substring(5,16)})}),j.dataset0.push({seriesname:"累计终端",data:[]}),c.addUpCount.forEach(function(a,b){j.dataset0[0].data.push({value:a}),j.dataSet0[b].addUpCount=a}),j.dataset0.push({seriesname:"在线终端",data:[]}),c.onlineCount.forEach(function(a,b){j.dataset0[1].data.push({value:a}),j.dataSet0[b].onlineCount=a}),j.dataset0.push({seriesname:"活跃终端",data:[]}),c.activeCount.forEach(function(a,b){j.dataset0[2].data.push({value:a}),j.dataSet0[b].activeCount=a}),j.dataset0.push({seriesname:"付费终端",data:[]}),c.payCount.forEach(function(a,b){j.dataset0[3].data.push({value:a}),j.dataSet0[b].payCount=a}),j.dataset0.push({name:"新增终端",data:[]}),c.newAddCount.forEach(function(a,b){j.dataset0[4].data.push({value:a}),j.dataSet0[b].newAddCount=a}),j.term.forEach(function(a,b){1==a.show&&j.series0.push(j.dataset0[b])}),j.dataset0=j.series0,b.resolve()):(alert(c.errInfo),b.reject())},function(a){alert("连接服务器出错"),b.reject()}).finally(function(a){j.loadingChart0=!1}),b.promise}();break;case 1:!function(){j.wantPaySeries=[],j.wantPayData=[],j.paySeries=[],j.payData=[],j.dataSet1=[];var c=JSON.stringify({token:h.getParams("token"),action:"getPayCountStatisticsInfo",endTime:"2017-03-23 10:00:00",project:["all"],timespans:7,type:2});j.loadingChart1=!0,a({method:"POST",url:h.getApiUrl("v2/statistics","","server"),data:c}).then(function(a){var c=a.data;"200"==c.rescode?(j.categories1[0].category=[],j.series=[],c.timeList.forEach(function(a,b){j.categories1[0].category.push({label:a.substring(5,16)}),j.wantPayData.push({datetime:a.substring(5,16)}),j.payData.push({datetime:a.substring(5,16)})}),j.wantPaySeries.push({seriesname:"准付费次数",data:[]}),c.wantPayCount.forEach(function(a,b){j.wantPaySeries[0].data.push({value:a}),j.wantPayData[b].payCount=a}),j.wantPaySeries.push({seriesname:"准付费次数（单次）",data:[]}),c.wantPaySingleCount.forEach(function(a,b){j.wantPaySeries[1].data.push({value:a}),j.wantPayData[b].paySingleCount=a}),j.wantPaySeries.push({seriesname:"准付费次数（打包）",data:[]}),c.wantPayPackageCount.forEach(function(a,b){j.wantPaySeries[2].data.push({value:a}),j.wantPayData[b].payPackageCount=a}),j.paySeries.push({seriesname:"付费次数",data:[]}),c.payCount.forEach(function(a,b){j.paySeries[0].data.push({value:a}),j.payData[b].payCount=a}),j.paySeries.push({seriesname:"付费次数（单次）",data:[]}),c.paySingleCount.forEach(function(a,b){j.paySeries[1].data.push({value:a}),j.payData[b].paySingleCount=a}),j.paySeries.push({seriesname:"付费次数（打包）",data:[]}),c.payPackageCount.forEach(function(a,b){j.paySeries[2].data.push({value:a}),j.payData[b].payPackageCount=a}),j.dataset1=j.paySeries,j.dataSet1=j.payData,b.resolve()):(alert(c.errInfo),b.reject())},function(a){alert("连接服务器出错"),b.reject()}).finally(function(a){j.loadingChart1=!1}),b.promise}();break;case 2:!function(){var c=JSON.stringify({token:h.getParams("token"),action:"getRevenueStatisticsInfo",endTime:"2017-03-23 10:00:00",project:["all"],timespans:7,type:2});j.loadingChart2=!0,a({method:"POST",url:h.getApiUrl("v2/statistics","","server"),data:c}).then(function(a){var c=a.data;"200"==c.rescode?(j.categories2[0].category=[],j.dataset2=[],j.revenueData=[],c.timeList.forEach(function(a,b){j.categories2[0].category.push({label:a.substring(5,16)}),j.revenueData.push({datetime:a.substring(5,16)})}),j.dataset2.push({seriesname:"总收益",data:[]}),c.totalMovieRevenue.forEach(function(a,b){j.dataset2[0].data.push({value:a/100}),j.revenueData[b].totalMovieRevenue=a/100}),j.dataset2.push({seriesname:"单次点播收益",data:[]}),c.singleMovieRevenue.forEach(function(a,b){j.dataset2[1].data.push({value:a/100}),j.revenueData[b].singleMovieRevenue=a/100}),j.dataset2.push({seriesname:"打包点播收益",data:[]}),c.packageMovieRevenue.forEach(function(a,b){j.dataset2[2].data.push({value:a/100}),j.revenueData[b].packageMovieRevenue=a/100}),b.resolve()):(alert(c.errInfo),b.reject())},function(a){alert("连接服务器出错"),b.reject()}).finally(function(a){j.loadingChart2=!1}),b.promise}();break;case 3:!function(){var c=0;switch(j.other.forEach(function(a,b){1==a.show&&(c=b)}),c){case 0:!function(){var c=JSON.stringify({token:h.getParams("token"),action:"getActiveStatisticsInfo",endTime:"2017-03-23 10:00:00",project:["all"],timespans:6,type:2});j.loadingChart3=!0,a({method:"POST",url:h.getApiUrl("v2/statistics","","server"),data:c}).then(function(a){var c=a.data;"200"==c.rescode?(j.categories3[0].category=[],j.dataset3=[],j.dataSet3=[],c.timeList.forEach(function(a,b){j.categories3[0].category.push({label:a.substring(5,16)}),j.dataSet3.push({datetime:a.substring(5,16)})}),j.dataset3.push({seriesname:"活跃时长",data:[]}),c.totalActiveTime.forEach(function(a,b){j.dataset3[0].data.push({value:a}),j.dataSet3[b].totalActiveTime=a}),j.dataset3.push({seriesname:"活跃终端数",data:[],renderAs:"line",parentYAxis:"S"}),c.activeCount.forEach(function(a,b){j.dataset3[1].data.push({value:a}),j.dataSet3[b].activeCount=a}),b.resolve()):(alert(c.errInfo),b.reject())},function(a){alert("连接服务器出错"),b.reject()}).finally(function(a){j.loadingChart3=!1}),b.promise}();break;case 1:!function(){var c=JSON.stringify({token:h.getParams("token"),action:"getXiTangTicketStatisticsInfo",endTime:"2017-03-23 10:00:00",project:["all"],timespans:7,type:2});j.loadingChart2=!0,a({method:"POST",url:h.getApiUrl("v2/statistics","","server"),data:c}).then(function(a){var c=a.data;"200"==c.rescode?(j.categories3[0].category=[],j.dataset3=[],j.revenueData=[],c.timeList.forEach(function(a,b){j.categories3[0].category.push({label:a.substring(5,16)}),j.revenueData.push({datetime:a.substring(5,16)})}),j.dataset3.push({seriesname:"总收益",data:[]}),c.totalMovieRevenue.forEach(function(a,b){j.dataset3[0].data.push({value:a/100}),j.revenueData[b].totalMovieRevenue=a/100}),j.dataset3.push({seriesname:"单次点播收益",data:[]}),c.singleMovieRevenue.forEach(function(a,b){j.dataset3[1].data.push({value:a/100}),j.revenueData[b].singleMovieRevenue=a/100}),j.dataset3.push({seriesname:"打包点播收益",data:[]}),c.packageMovieRevenue.forEach(function(a,b){j.dataset3[2].data.push({value:a/100}),j.revenueData[b].packageMovieRevenue=a/100}),b.resolve()):(alert(c.errInfo),b.reject())},function(a){alert("连接服务器出错"),b.reject()}).finally(function(a){j.loadingChart2=!1}),b.promise}()}}()}},j.changeOrderby=function(a){j.orderby.sort=a,j.orderby.desc=!j.orderby.desc}}])}(),function(){angular.module("app.directives",[]).directive("fileModel",["$parse","CONFIG",function(a,b){return{restrict:"A",link:function(b,c,d){var e=a(d.fileModel),f=e.assign;c.bind("change",function(){b.$apply(function(){f(b,c[0].files[0])}),"none"!=d.e&&document.getElementById(d.e).click()})}}}])}(),function(){angular.module("app.services",[]).factory("util",["$cookies","$translate","CONFIG",function(a,b,c){return{getApiUrl:function(a,b,d){return d?"server"==d?c.serverUrl+a:c.testUrl+b:c.test?c.testUrl+b:c.serverUrl+a},getUploadUrl:function(){return c.uploadUrl},setParams:function(b,c){a.put(b,JSON.stringify(c))},getParams:function(b){return!!a.get(b)&&JSON.parse(a.get(b))},langStyle:function(){return b.proposedLanguage()||b.use()},getDefaultLangCode:function(){var b=[];a.get("editLangs")&&(b=JSON.parse(a.get("editLangs")));for(var c=0;c<b.length;c++)if(b[c].default)return b[c].code},uploadFileToUrl:function(a,b,c,d,e,f,g){var d=d?d:"normal",h=new FormData;h.append("action",d),h.append("file",b),a.open("POST",c,!0),a.upload.addEventListener("progress",function(a){e(a)},!1),a.onreadystatechange=function(b){4==a.readyState&&200==a.status&&""!=a.responseText?(console.log(JSON.parse(a.responseText)),0!==JSON.parse(a.responseText).result?g(a):f(a)):200!=a.status&&a.responseText&&g(a)},a.send(h)}}}])}(),function(){angular.module("app.filters",[]).filter("ajaxMethod",["CONFIG",function(a){return function(){return a.test?"GET":"POST"}}]).filter("fenToYuan",function(){return function(a){var b=a+"";return 1==b.length?b="00"+b:2==b.length&&(b="0"+b),b.slice(0,-2)+"."+b.slice(-2)}}).filter("subtitlePercentComplete",function(){return function(a){return a?"失败"==a?a:a+"%":"无"}})}();