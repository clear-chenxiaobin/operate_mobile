/*! openvod | emma | ISC */
"use strict";!function(){angular.module("app.controllers",[]).controller("indexController",["$scope",function(a){this.init=function(){this.maskUrl=""}}]).controller("loginController",["$scope","$http","$state","$filter","md5","util",function(a,b,c,d,e,f){var g=this;g.init=function(){},g.login=function(){g.loading=!0;var a=JSON.stringify({username:g.userName,password:e.createHash(g.password)});b({method:"POST",url:f.getApiUrl("v1/logon","","server"),data:a}).then(function(a){var b=a.data;"200"==b.rescode?(f.setParams("token",b.token),g.getEditLangs()):alert(b.rescode+" "+b.errInfo)},function(a){alert("连接服务器出错")}).finally(function(a){g.loading=!1})},g.getEditLangs=function(){b({method:"GET",url:f.getApiUrl("","editLangs.json","local")}).then(function(a){f.setParams("editLangs",a.data.editLangs),c.go("app.home")},function(a){})}}]).controller("appController",["$http","$scope","$state","$stateParams","util","CONFIG",function(a,b,c,d,e,f){var g=this;g.init=function(){g.maskUrl="",g.maskParams={},b.granularity=[{id:0,name:"小时"},{id:1,name:"日"},{id:2,name:"周"},{id:3,name:"月"},{id:4,name:"年"}]},g.showHideMask=function(a,c){a?(b.app.maskUrl=c,b.app.showMaskClass=!0):(b.app.maskUrl="",b.app.showMaskClass=!1)},b.dtSubstr=function(a,b){switch(b){case 0:return a.substring(5,16);case 1:return a.substring(5,10);case 2:return a.substring(5,10);case 3:return a.substring(0,7);case 4:return a.substring(0,4)}}}]).controller("homeController",["$http","$scope","$state","$location","$filter","$stateParams","$q","util","CONFIG",function(a,b,c,d,e,f,g,h,i){var j=this;j.init=function(){j.getProject()},j.logout=function(){h.setParams("token",""),c.go("login")},j.getProject=function(){var c=g.defer(),d=JSON.stringify({token:h.getParams("token"),action:"projectList"});a({method:"POST",url:h.getApiUrl("v1/project","","server"),data:d}).then(function(a){var d=a.data;"200"==d.rescode?(b.app.projectList=[],b.app.projectList[0]={projectName:"all",projectNameCHZ:"所有项目"},d.data.forEach(function(a){b.app.projectList.push({projectName:a.ProjectName,projectNameCHZ:a.ProjectNameCHZ})}),b.app.selectProject="all",h.setParams("project","all"),c.resolve()):(alert(d.errInfo),c.reject())},function(a){alert("连接服务器出错"),c.reject()}).finally(function(a){j.loadingChart0=!1})}}]).controller("overviewController",["$http","$scope","$state","$location","$filter","$stateParams","$q","util","CONFIG",function(a,b,c,d,e,f,g,h,i){function j(){b.$broadcast("end-date-changed"),l.loadChart()}function k(a){if(b.dateRangeEnd){var c=moment(b.dateRangeEnd);a.filter(function(a){return a.localDateValue()>=c.valueOf()}).forEach(function(a){a.selectable=!1})}}var l=this;moment.locale("zh-cn"),b.endDateBeforeRender=k,b.endDateOnSetTime=j,l.init=function(){l.term=[{name:"累计终端",value:!0,sort:"",desc:!1},{name:"上线终端",value:!0,sort:"",desc:!1},{name:"活跃终端",value:!0,sort:"",desc:!1}],l.activerow=0,b.dateRangeEnd=e("date")(new Date,"yyyy-MM-dd"),l.searchDate=e("date")((new Date).getTime(),"yyyy-MM-dd"),l.selectGra0=1,l.selectGra1=1,l.selectGra2=1,l.selectGra3=1,l.isDate=[!0,!0,!0,!0],l.initCharts(),l.loadChart()},l.isCurrent=function(a){l.activerow!=a&&(l.activerow=a,l.loadChart())},l.changeGra=function(a,b){0==a?(l.isDate[b]=!1,10==l.searchDate.length&&(l.searchDate+=" 00:00")):(l.isDate[b]=!0,16==l.searchDate.length&&(l.searchDate=l.searchDate.substring(0,10))),l.loadChart()},l.changeProject=function(a){h.setParams("project",a),l.loadChart()},l.initCharts=function(){l.attrs0={caption:"",xAxisname:"时间",yAxisName:"开机率",numberPrefix:"",numberSuffix:"%",plotFillAlpha:"60",paletteColors:"#0075c2,#1aaf5d",baseFontColor:"#333333",baseFont:"Helvetica Neue,Arial",captionFontSize:"14",subcaptionFontSize:"14",subcaptionFontBold:"0",showBorder:"0",bgColor:"#ffffff",showShadow:"0",showValues:"0",canvasBgColor:"#ffffff",canvasBorderAlpha:"0",divlineAlpha:"100",divlineColor:"#999999",divlineThickness:"1",divLineIsDashed:"1",divLineDashLen:"1",divLineGapLen:"1",usePlotGradientColor:"0",showplotborder:"0",valueFontColor:"#000000",placeValuesInside:"1",showHoverEffect:"1",rotateValues:"0",showXAxisLine:"1",xAxisLineThickness:"1",xAxisLineColor:"#999999",showAlternateHGridColor:"0",legendBgAlpha:"0",legendBorderAlpha:"0",legendShadow:"0",legendItemFontSize:"10",legendItemFontColor:"#666666"},l.categories0=[{category:[]}],l.dataset0=[],l.attrs1={caption:"",xAxisname:"时间",yAxisName:"活跃率",numberPrefix:"",numberSuffix:"%",plotFillAlpha:"60",paletteColors:"#0075c2,#1aaf5d",baseFontColor:"#333333",baseFont:"Helvetica Neue,Arial",captionFontSize:"14",subcaptionFontSize:"14",subcaptionFontBold:"0",showBorder:"0",bgColor:"#ffffff",showShadow:"0",showValues:"0",canvasBgColor:"#ffffff",canvasBorderAlpha:"0",divlineAlpha:"100",divlineColor:"#999999",divlineThickness:"1",divLineIsDashed:"1",divLineDashLen:"1",divLineGapLen:"1",usePlotGradientColor:"0",showplotborder:"0",valueFontColor:"#000000",placeValuesInside:"1",showHoverEffect:"1",rotateValues:"0",showXAxisLine:"1",xAxisLineThickness:"1",xAxisLineColor:"#999999",showAlternateHGridColor:"0",legendBgAlpha:"0",legendBorderAlpha:"0",legendShadow:"0",legendItemFontSize:"10",legendItemFontColor:"#666666"},l.categories1=[{category:[]}],l.dataset1=[],l.attrs2={caption:"",xAxisname:"时间",yAxisName:"付费转化率",numberPrefix:"",numberSuffix:"%",plotFillAlpha:"60",paletteColors:"#0075c2,#1aaf5d",baseFontColor:"#333333",baseFont:"Helvetica Neue,Arial",captionFontSize:"14",subcaptionFontSize:"14",subcaptionFontBold:"0",showBorder:"0",bgColor:"#ffffff",showShadow:"0",showValues:"0",canvasBgColor:"#ffffff",canvasBorderAlpha:"0",divlineAlpha:"100",divlineColor:"#999999",divlineThickness:"1",divLineIsDashed:"1",divLineDashLen:"1",divLineGapLen:"1",usePlotGradientColor:"0",showplotborder:"0",valueFontColor:"#000000",placeValuesInside:"1",showHoverEffect:"1",rotateValues:"0",showXAxisLine:"1",xAxisLineThickness:"1",xAxisLineColor:"#999999",showAlternateHGridColor:"0",legendBgAlpha:"0",legendBorderAlpha:"0",legendShadow:"0",legendItemFontSize:"10",legendItemFontColor:"#666666"},l.categories2=[{category:[]}],l.dataset2=[],l.attrs3={caption:"",xAxisname:"时间",yAxisName:"平均每终端营收",numberPrefix:"",numberSuffix:"元",plotFillAlpha:"60",paletteColors:"#0075c2,#1aaf5d",baseFontColor:"#333333",baseFont:"Helvetica Neue,Arial",captionFontSize:"14",subcaptionFontSize:"14",subcaptionFontBold:"0",showBorder:"0",bgColor:"#ffffff",showShadow:"0",showValues:"0",canvasBgColor:"#ffffff",canvasBorderAlpha:"0",divlineAlpha:"100",divlineColor:"#999999",divlineThickness:"1",divLineIsDashed:"1",divLineDashLen:"1",divLineGapLen:"1",usePlotGradientColor:"0",showplotborder:"0",valueFontColor:"#000000",placeValuesInside:"1",showHoverEffect:"1",rotateValues:"0",showXAxisLine:"1",xAxisLineThickness:"1",xAxisLineColor:"#999999",showAlternateHGridColor:"0",legendBgAlpha:"0",legendBorderAlpha:"0",legendShadow:"0",legendItemFontSize:"10",legendItemFontColor:"#666666"},l.categories3=[{category:[]}],l.dataset3=[]},l.loadChart=function(){var c=g.defer();switch(l.activerow){case 0:!function(){var d=JSON.stringify({token:h.getParams("token"),action:"getTermOnlineRateInfo",endTime:10==l.searchDate.length?l.searchDate+" 00:00:00":l.searchDate+":00",project:[h.getParams("project")],timespans:7,type:l.selectGra0});l.loadingChart0=!0,a({method:"POST",url:h.getApiUrl("v2/statistics","","server"),data:d}).then(function(a){var d=a.data;"200"==d.rescode?(l.dataset0=[],l.dataSet0=[],l.categories0[0].category=[],d.timeList.forEach(function(a,c){l.categories0[0].category.push({label:b.dtSubstr(a,l.selectGra0)}),l.dataSet0.push({datetime:b.dtSubstr(a,l.selectGra0)})}),l.dataset0.push({seriesname:"开机率",data:[]}),d.onlineRate.forEach(function(a,b){l.dataset0[0].data.push({value:100*a}),l.dataSet0[b].onlineRate=100*a+"%"}),c.resolve()):(alert(d.errInfo),c.reject())},function(a){alert("连接服务器出错"),c.reject()}).finally(function(a){l.loadingChart0=!1})}();break;case 1:!function(){var d=JSON.stringify({token:h.getParams("token"),action:"getTermActiveRateInfo",endTime:10==l.searchDate.length?l.searchDate+" 00:00:00":l.searchDate+":00",project:[h.getParams("project")],timespans:7,type:l.selectGra1});l.loadingChart1=!0,a({method:"POST",url:h.getApiUrl("v2/statistics","","server"),data:d}).then(function(a){var d=a.data;"200"==d.rescode?(l.dataset1=[],l.dataSet1=[],l.categories1[0].category=[],d.timeList.forEach(function(a,c){l.categories1[0].category.push({label:b.dtSubstr(a,l.selectGra1)}),l.dataSet1.push({datetime:b.dtSubstr(a,l.selectGra1)})}),l.dataset1.push({seriesname:"活跃率",data:[]}),d.activeRate.forEach(function(a,b){l.dataset1[0].data.push({value:100*a}),l.dataSet1[b].activeRate=100*a+"%"}),c.resolve()):(alert(d.errInfo),c.reject())},function(a){alert("连接服务器出错"),c.reject()}).finally(function(a){l.loadingChart1=!1})}();break;case 2:!function(){var d=JSON.stringify({token:h.getParams("token"),action:"getTermPayRateInfo",endTime:10==l.searchDate.length?l.searchDate+" 00:00:00":l.searchDate+":00",project:[h.getParams("project")],timespans:7,type:l.selectGra2});l.loadingChart2=!0,a({method:"POST",url:h.getApiUrl("v2/statistics","","server"),data:d}).then(function(a){var d=a.data;"200"==d.rescode?(l.dataset2=[],l.dataSet2=[],l.categories2[0].category=[],d.timeList.forEach(function(a,c){l.categories2[0].category.push({label:b.dtSubstr(a,l.selectGra2)}),l.dataSet2.push({datetime:b.dtSubstr(a,l.selectGra2)})}),l.dataset2.push({seriesname:"付费转化率",data:[]}),d.payRate.forEach(function(a,b){l.dataset2[0].data.push({value:100*a}),l.dataSet2[b].payRate=100*a+"%"}),c.resolve()):(alert(d.errInfo),c.reject())},function(a){alert("连接服务器出错"),c.reject()}).finally(function(a){l.loadingChart2=!1})}();break;case 3:!function(){var d=JSON.stringify({token:h.getParams("token"),action:"getPerTermRevenueInfo",endTime:10==l.searchDate.length?l.searchDate+" 00:00:00":l.searchDate+":00",project:[h.getParams("project")],timespans:7,type:l.selectGra3});l.loadingChart3=!0,a({method:"POST",url:h.getApiUrl("v2/statistics","","server"),data:d}).then(function(a){var d=a.data;"200"==d.rescode?(l.dataset3=[],l.dataSet3=[],l.categories3[0].category=[],d.timeList.forEach(function(a,c){l.categories3[0].category.push({label:b.dtSubstr(a,l.selectGra3)}),l.dataSet3.push({datetime:b.dtSubstr(a,l.selectGra3)})}),l.dataset3.push({seriesname:"付费转化率",data:[]}),d.revenue.forEach(function(a,b){l.dataset3[0].data.push({value:a}),l.dataSet3[b].revenue=a}),c.resolve()):(alert(d.errInfo),c.reject())},function(a){alert("连接服务器出错"),c.reject()}).finally(function(a){l.loadingChart3=!1})}()}return c.promise},l.changeOrderby=function(a){l.term.sort=a,l.term.desc=!l.term.desc}}]).controller("specificController",["$http","$scope","$state","$location","$filter","$stateParams","$q","util","CONFIG",function(a,b,c,d,e,f,g,h,i){function j(){b.$broadcast("end-date-changed"),l.loadChart()}function k(a){if(b.dateRangeEnd){var c=moment(b.dateRangeEnd);a.filter(function(a){return a.localDateValue()>=c.valueOf()}).forEach(function(a){a.selectable=!1})}}var l=this;moment.locale("zh-cn"),b.endDateBeforeRender=k,b.endDateOnSetTime=j,l.init=function(){l.project=[{name:"opennVoD"},{name:"西塘"}],l.activerow=0,l.term=[{name:"累计终端",show:!0,sort:"",desc:!1},{name:"上线终端",show:!0,sort:"",desc:!1},{name:"活跃终端",show:!0,sort:"",desc:!1},{name:"付费终端",show:!1,sort:"",desc:!1},{name:"新增终端",show:!1,sort:"",desc:!1}],l.countStatistics=[{name:"准付费次数",show:!1,sort:"",desc:!1},{name:"付 费 次 数",show:!0,sort:"",desc:!1}],l.selectCount=3,l.other=[{name:"活跃时长",show:!0,sort:"",desc:!1},{name:"西塘票务",show:!1,sort:"",desc:!1}],l.initCharts(),b.dateRangeEnd=e("date")(new Date,"yyyy-MM-dd"),l.searchDate=e("date")((new Date).getTime(),"yyyy-MM-dd"),l.selectGra0=1,l.selectGra1=1,l.selectGra2=1,l.selectGra3=1,l.isDate=[!0,!0,!0,!0],l.loadChart(),l.orderby={},l.orderby.desc=!1},l.isCurrent=function(a){l.activerow!=a&&(l.activerow=a,l.loadChart())},l.changeProject=function(a){h.setParams("project",a),l.loadChart()},l.changeGra=function(a,b){0==a?(l.isDate[b]=!1,10==l.searchDate.length&&(l.searchDate+=" 00:00")):(l.isDate[b]=!0,16==l.searchDate.length&&(l.searchDate=l.searchDate.substring(0,10))),l.loadChart()},l.selectTerm=function(a){if(1==l.term[a].show)l.selectCount--;else{if(!(0==l.term[a].show&&l.selectCount<3))return alert("最多只能选择3个显示！"),!1;l.selectCount++}l.term[a].show=!l.term[a].show,l.series0=[],l.term.forEach(function(a,b){1==a.show&&l.series0.push(l.termDate[b])}),l.dataset0=l.series0},l.selectCountStatistics=function(a){0==l.countStatistics[a].show&&(0==a?(l.countStatistics[0].show=!0,l.countStatistics[1].show=!1,l.dataset1=l.wantPaySeries,l.dataSet1=l.wantPayData):(l.countStatistics[0].show=!1,l.countStatistics[1].show=!0,l.dataset1=l.paySeries,l.dataSet1=l.payData))},l.selectOther=function(a){l.other.forEach(function(a){a.show=!1}),l.other[a].show=!0},l.initCharts=function(){l.attrs0={caption:"",xAxisname:"时间",yAxisName:"终端",numberPrefix:"",numberSuffix:" 个",plotFillAlpha:"60",paletteColors:"#0075c2,#1aaf5d",baseFontColor:"#333333",baseFont:"Helvetica Neue,Arial",captionFontSize:"14",subcaptionFontSize:"14",subcaptionFontBold:"0",showBorder:"0",bgColor:"#ffffff",showShadow:"0",showValues:"0",canvasBgColor:"#ffffff",canvasBorderAlpha:"0",divlineAlpha:"100",divlineColor:"#999999",divlineThickness:"1",divLineIsDashed:"1",divLineDashLen:"1",divLineGapLen:"1",usePlotGradientColor:"0",showplotborder:"0",valueFontColor:"#000000",placeValuesInside:"1",showHoverEffect:"1",rotateValues:"0",showXAxisLine:"1",xAxisLineThickness:"1",xAxisLineColor:"#999999",showAlternateHGridColor:"0",legendBgAlpha:"0",legendBorderAlpha:"0",legendShadow:"0",legendItemFontSize:"10",legendItemFontColor:"#666666"},l.categories0=[{category:[]}],l.dataset0=[],l.attrs1={caption:"",xAxisname:"时间",yAxisName:"次数",numberPrefix:"",numberSuffix:" 次",plotFillAlpha:"60",paletteColors:"#0075c2,#1aaf5d",baseFontColor:"#333333",baseFont:"Helvetica Neue,Arial",captionFontSize:"14",subcaptionFontSize:"14",subcaptionFontBold:"0",showBorder:"0",bgColor:"#ffffff",showShadow:"0",showValues:"0",canvasBgColor:"#ffffff",canvasBorderAlpha:"0",divlineAlpha:"100",divlineColor:"#999999",divlineThickness:"1",divLineIsDashed:"1",divLineDashLen:"1",divLineGapLen:"1",usePlotGradientColor:"0",showplotborder:"0",valueFontColor:"#000000",placeValuesInside:"1",showHoverEffect:"1",rotateValues:"0",showXAxisLine:"1",xAxisLineThickness:"1",xAxisLineColor:"#999999",showAlternateHGridColor:"0",legendBgAlpha:"0",legendBorderAlpha:"0",legendShadow:"0",legendItemFontSize:"10",legendItemFontColor:"#666666"},l.categories1=[{category:[]}],l.dataset1=[],l.attrs2={caption:"",xAxisname:"时间",yAxisName:"金额",numberPrefix:"¥ ",numberSuffix:"",plotFillAlpha:"60",paletteColors:"#0075c2,#1aaf5d",baseFontColor:"#333333",baseFont:"Helvetica Neue,Arial",captionFontSize:"14",subcaptionFontSize:"14",subcaptionFontBold:"0",showBorder:"0",bgColor:"#ffffff",showShadow:"0",showValues:"0",canvasBgColor:"#ffffff",canvasBorderAlpha:"0",divlineAlpha:"100",divlineColor:"#999999",divlineThickness:"1",divLineIsDashed:"1",divLineDashLen:"1",divLineGapLen:"1",usePlotGradientColor:"0",showplotborder:"0",valueFontColor:"#000000",placeValuesInside:"1",showHoverEffect:"1",rotateValues:"0",showXAxisLine:"1",xAxisLineThickness:"1",xAxisLineColor:"#999999",showAlternateHGridColor:"0",legendBgAlpha:"0",legendBorderAlpha:"0",legendShadow:"0",legendItemFontSize:"10",legendItemFontColor:"#666666"},l.categories2=[{category:[]}],l.dataset2=[],l.attrs3={caption:"",xAxisname:"时间",pYAxisName:"活跃时长",sYAxisName:"活跃终端数",numberPrefix:"",numberSuffix:"小时",sNumberSuffix:"个",plotFillAlpha:"60",paletteColors:"#0075c2,#1aaf5d",baseFontColor:"#333333",baseFont:"Helvetica Neue,Arial",captionFontSize:"14",subcaptionFontSize:"14",subcaptionFontBold:"0",showBorder:"0",bgColor:"#ffffff",showShadow:"0",showValues:"0",canvasBgColor:"#ffffff",canvasBorderAlpha:"0",divlineAlpha:"100",divlineColor:"#999999",divlineThickness:"1",divLineIsDashed:"1",divLineDashLen:"1",divLineGapLen:"1",usePlotGradientColor:"0",showplotborder:"0",valueFontColor:"#000000",placeValuesInside:"1",showHoverEffect:"1",rotateValues:"0",showXAxisLine:"1",xAxisLineThickness:"1",xAxisLineColor:"#999999",showAlternateHGridColor:"0",legendBgAlpha:"0",legendBorderAlpha:"0",legendShadow:"0",legendItemFontSize:"10",legendItemFontColor:"#666666"},l.categories3=[{category:[]}],l.dataset3=[]},l.loadChart=function(){var c=g.defer();switch(l.activerow){case 0:!function(){var d=JSON.stringify({token:h.getParams("token"),action:"getTermStatisticsInfo",endTime:10==l.searchDate.length?l.searchDate+" 00:00:00":l.searchDate+":00",project:[h.getParams("project")],timespans:7,type:l.selectGra0});l.loadingChart0=!0,a({method:"POST",url:h.getApiUrl("v2/statistics","","server"),data:d}).then(function(a){var d=a.data;"200"==d.rescode?(l.dataset0=[],l.dataSet0=[],l.termDate=[],l.series0=[],l.categories0[0].category=[],l.dataSet0=[],d.timeList.forEach(function(a,c){l.categories0[0].category.push({label:b.dtSubstr(a,l.selectGra0)}),l.dataSet0.push({datetime:b.dtSubstr(a,l.selectGra0)})}),l.dataset0.push({seriesname:"累计终端",data:[]}),d.addUpCount.forEach(function(a,b){l.dataset0[0].data.push({value:a}),l.dataSet0[b].addUpCount=a}),l.dataset0.push({seriesname:"在线终端",data:[]}),d.onlineCount.forEach(function(a,b){l.dataset0[1].data.push({value:a}),l.dataSet0[b].onlineCount=a}),l.dataset0.push({seriesname:"活跃终端",data:[]}),d.activeCount.forEach(function(a,b){l.dataset0[2].data.push({value:a}),l.dataSet0[b].activeCount=a}),l.dataset0.push({seriesname:"付费终端",data:[]}),d.payCount.forEach(function(a,b){l.dataset0[3].data.push({value:a}),l.dataSet0[b].payCount=a}),l.dataset0.push({seriesname:"新增终端",data:[]}),d.newAddCount.forEach(function(a,b){l.dataset0[4].data.push({value:a}),l.dataSet0[b].newAddCount=a}),l.termDate=l.dataset0,l.term.forEach(function(a,b){1==a.show&&l.series0.push(l.dataset0[b])}),l.dataset0=l.series0,c.resolve()):(alert(d.errInfo),c.reject())},function(a){alert("连接服务器出错"),c.reject()}).finally(function(a){l.loadingChart0=!1}),c.promise}();break;case 1:!function(){var d=JSON.stringify({token:h.getParams("token"),action:"getPayCountStatisticsInfo",endTime:10==l.searchDate.length?l.searchDate+" 00:00:00":l.searchDate+":00",project:[h.getParams("project")],timespans:7,type:l.selectGra1});l.loadingChart1=!0,a({method:"POST",url:h.getApiUrl("v2/statistics","","server"),data:d}).then(function(a){var d=a.data;"200"==d.rescode?(l.wantPaySeries=[],l.wantPayData=[],l.paySeries=[],l.payData=[],l.dataset1=[],l.dataSet1=[],l.categories1[0].category=[],l.series=[],d.timeList.forEach(function(a,c){l.categories1[0].category.push({label:b.dtSubstr(a,l.selectGra1)}),l.wantPayData.push({datetime:b.dtSubstr(a,l.selectGra1)}),l.payData.push({datetime:a.substring(5,16)})}),l.wantPaySeries.push({seriesname:"准付费次数",data:[]}),d.wantPayCount.forEach(function(a,b){l.wantPaySeries[0].data.push({value:a}),l.wantPayData[b].payCount=a}),l.wantPaySeries.push({seriesname:"准付费次数（单次）",data:[]}),d.wantPaySingleCount.forEach(function(a,b){l.wantPaySeries[1].data.push({value:a}),l.wantPayData[b].paySingleCount=a}),l.wantPaySeries.push({seriesname:"准付费次数（打包）",data:[]}),d.wantPayPackageCount.forEach(function(a,b){l.wantPaySeries[2].data.push({value:a}),l.wantPayData[b].payPackageCount=a}),l.paySeries.push({seriesname:"付费次数",data:[]}),d.payCount.forEach(function(a,b){l.paySeries[0].data.push({value:a}),l.payData[b].payCount=a}),l.paySeries.push({seriesname:"付费次数（单次）",data:[]}),d.paySingleCount.forEach(function(a,b){l.paySeries[1].data.push({value:a}),l.payData[b].paySingleCount=a}),l.paySeries.push({seriesname:"付费次数（打包）",data:[]}),d.payPackageCount.forEach(function(a,b){l.paySeries[2].data.push({value:a}),l.payData[b].payPackageCount=a}),l.dataset1=l.paySeries,l.dataSet1=l.payData,c.resolve()):(alert(d.errInfo),c.reject())},function(a){alert("连接服务器出错"),c.reject()}).finally(function(a){l.loadingChart1=!1}),c.promise}();break;case 2:!function(){var d=JSON.stringify({token:h.getParams("token"),action:"getRevenueStatisticsInfo",endTime:10==l.searchDate.length?l.searchDate+" 00:00:00":l.searchDate+":00",project:[h.getParams("project")],timespans:7,type:l.selectGra2});l.loadingChart2=!0,a({method:"POST",url:h.getApiUrl("v2/statistics","","server"),data:d}).then(function(a){var d=a.data;"200"==d.rescode?(l.categories2[0].category=[],l.dataset2=[],l.revenueData=[],d.timeList.forEach(function(a,c){l.categories2[0].category.push({label:b.dtSubstr(a,l.selectGra2)}),l.revenueData.push({datetime:b.dtSubstr(a,l.selectGra2)})}),l.dataset2.push({seriesname:"总收益",data:[]}),d.totalMovieRevenue.forEach(function(a,b){l.dataset2[0].data.push({value:a/100}),l.revenueData[b].totalMovieRevenue=a/100}),l.dataset2.push({seriesname:"单次点播收益",data:[]}),d.singleMovieRevenue.forEach(function(a,b){l.dataset2[1].data.push({value:a/100}),l.revenueData[b].singleMovieRevenue=a/100}),l.dataset2.push({seriesname:"打包点播收益",data:[]}),d.packageMovieRevenue.forEach(function(a,b){l.dataset2[2].data.push({value:a/100}),l.revenueData[b].packageMovieRevenue=a/100}),c.resolve()):(alert(d.errInfo),c.reject())},function(a){alert("连接服务器出错"),c.reject()}).finally(function(a){l.loadingChart2=!1}),c.promise}();break;case 3:!function(){var d=0;switch(l.other.forEach(function(a,b){1==a.show&&(d=b)}),d){case 0:!function(){var d=JSON.stringify({token:h.getParams("token"),action:"getActiveStatisticsInfo",endTime:10==l.searchDate.length?l.searchDate+" 00:00:00":l.searchDate+":00",project:[h.getParams("project")],timespans:6,type:l.selectGra3});l.loadingChart3=!0,a({method:"POST",url:h.getApiUrl("v2/statistics","","server"),data:d}).then(function(a){var d=a.data;"200"==d.rescode?(l.categories3[0].category=[],l.dataset3=[],l.dataSet3=[],d.timeList.forEach(function(a,c){l.categories3[0].category.push({label:b.dtSubstr(a,l.selectGra3)}),l.dataSet3.push({datetime:b.dtSubstr(a,l.selectGra3)})}),l.dataset3.push({seriesname:"活跃时长",data:[]}),d.totalActiveTime.forEach(function(a,b){function c(a){return a<10&&(a+="0"),a}l.dataset3[0].data.push({value:(a/3600).toFixed(2)});var d=Math.floor(a/3600),e=Math.floor((a-3600*d)/60),f=a-3600*d-60*e;l.dataSet3[b].totalActiveTime=d+":"+c(e)+":"+c(f)}),l.dataset3.push({seriesname:"活跃终端数",renderAs:"line",parentYAxis:"S",showValues:"0",data:[]}),d.activeCount.forEach(function(a,b){l.dataset3[1].data.push({value:a}),l.dataSet3[b].activeCount=a}),c.resolve()):(alert(d.errInfo),c.reject())},function(a){alert("连接服务器出错"),c.reject()}).finally(function(a){l.loadingChart3=!1}),c.promise}();break;case 1:!function(){var b=JSON.stringify({token:h.getParams("token"),action:"getXiTangTicketStatisticsInfo",endTime:10==l.searchDate.length?l.searchDate+" 00:00:00":l.searchDate+":00",project:[h.getParams("project")],timespans:7,type:2});l.loadingChart2=!0,a({method:"POST",url:h.getApiUrl("v2/statistics","","server"),data:b}).then(function(a){var b=a.data;"200"==b.rescode?(l.categories3[0].category=[],l.dataset3=[],l.revenueData=[],b.timeList.forEach(function(a,b){l.categories3[0].category.push({label:a.substring(5,16)}),l.revenueData.push({datetime:a.substring(5,16)})}),l.dataset3.push({seriesname:"总收益",data:[]}),b.totalMovieRevenue.forEach(function(a,b){l.dataset3[0].data.push({value:a/100}),l.revenueData[b].totalMovieRevenue=a/100}),l.dataset3.push({seriesname:"单次点播收益",data:[]}),b.singleMovieRevenue.forEach(function(a,b){l.dataset3[1].data.push({value:a/100}),l.revenueData[b].singleMovieRevenue=a/100}),l.dataset3.push({seriesname:"打包点播收益",data:[]}),b.packageMovieRevenue.forEach(function(a,b){l.dataset3[2].data.push({value:a/100}),l.revenueData[b].packageMovieRevenue=a/100}),c.resolve()):(alert(b.errInfo),c.reject())},function(a){alert("连接服务器出错"),c.reject()}).finally(function(a){l.loadingChart2=!1}),c.promise}()}}()}},l.changeOrderby=function(a){l.orderby.sort=a,l.orderby.desc=!l.orderby.desc}}])}(),function(){angular.module("app.directives",[]).directive("fileModel",["$parse","CONFIG",function(a,b){return{restrict:"A",link:function(b,c,d){var e=a(d.fileModel),f=e.assign;c.bind("change",function(){b.$apply(function(){f(b,c[0].files[0])}),"none"!=d.e&&document.getElementById(d.e).click()})}}}])}(),function(){angular.module("app.services",[]).factory("util",["$cookies","$translate","CONFIG",function(a,b,c){return{getApiUrl:function(a,b,d){return d?"server"==d?c.serverUrl+a:c.testUrl+b:c.test?c.testUrl+b:c.serverUrl+a},getUploadUrl:function(){return c.uploadUrl},setParams:function(b,c){a.put(b,JSON.stringify(c))},getParams:function(b){return!!a.get(b)&&JSON.parse(a.get(b))},langStyle:function(){return b.proposedLanguage()||b.use()},getDefaultLangCode:function(){var b=[];a.get("editLangs")&&(b=JSON.parse(a.get("editLangs")));for(var c=0;c<b.length;c++)if(b[c].default)return b[c].code},uploadFileToUrl:function(a,b,c,d,e,f,g){var d=d?d:"normal",h=new FormData;h.append("action",d),h.append("file",b),a.open("POST",c,!0),a.upload.addEventListener("progress",function(a){e(a)},!1),a.onreadystatechange=function(b){4==a.readyState&&200==a.status&&""!=a.responseText?(console.log(JSON.parse(a.responseText)),0!==JSON.parse(a.responseText).result?g(a):f(a)):200!=a.status&&a.responseText&&g(a)},a.send(h)}}}])}(),function(){angular.module("app.filters",[]).filter("ajaxMethod",["CONFIG",function(a){return function(){return a.test?"GET":"POST"}}]).filter("fenToYuan",function(){return function(a){var b=a+"";return 1==b.length?b="00"+b:2==b.length&&(b="0"+b),b.slice(0,-2)+"."+b.slice(-2)}}).filter("subtitlePercentComplete",function(){return function(a){return a?"失败"==a?a:a+"%":"无"}})}();